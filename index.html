<!DOCTYPE html>
<html>
<head>
  <title>Paramount Phones & Gadgets</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body {margin:0; font-family:Arial,sans-serif; background:#f9f9f9; color:#111;}
    header {background:#222; color:white; padding:20px; text-align:center; box-shadow:0 4px 10px rgba(0,0,0,0.3);}
    nav {background:#111; padding:10px; text-align:center;}
    nav a {color:white; margin:10px; text-decoration:none; font-weight:bold; cursor:pointer; transition:0.2s;}
    nav a:hover {color:#f9d423;}
    .hero {padding:50px 20px; text-align:center; color:white; border-bottom-left-radius:20px; border-bottom-right-radius:20px; position:relative;}
    #searchWrapper {text-align:center; margin:20px;}
    #searchInput {padding:12px; width:90%; max-width:500px; border-radius:10px; border:1px solid #ccc; box-shadow:0 2px 5px rgba(0,0,0,0.1);}
    .products, #adminProducts, #cartItemsWrapper, #ordersWrapper {padding:20px; display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:20px;}
    .card {border-radius:15px; padding:15px; text-align:center; background:white; transition:transform 0.25s, box-shadow 0.25s; box-shadow:0 4px 12px rgba(0,0,0,0.08); position:relative; cursor:pointer;}
    .card:hover {transform:translateY(-5px); box-shadow:0 10px 30px rgba(0,0,0,0.15);}
    .card img {width:100%; height:200px; object-fit:contain; border-radius:12px;}
    .hotBadge {position:absolute; top:10px; right:10px; background:red; color:white; padding:5px 10px; border-radius:12px; font-size:12px; font-weight:bold;}
    button {background:linear-gradient(90deg,#ff4e50,#f9d423); color:white; border-radius:10px; border:none; padding:12px; margin-top:8px; cursor:pointer; width:100%; font-weight:700; transition:transform .15s, box-shadow .15s;}
    button:hover {transform:scale(1.03); box-shadow:0 6px 18px rgba(0,0,0,0.18);}
    footer {background:black; color:white; text-align:center; padding:15px; margin-top:20px;}
    #cart, #admin {padding:20px; display:none;}
    input[type=text], input[type=password], input[type=file], input[type=color], input[type=email], textarea {width:100%; padding:10px; margin-bottom:10px; border-radius:8px; border:1px solid #ccc; box-sizing:border-box;}
    .smallBtn {padding:6px; font-size:12px; margin-top:6px;}
    @media (max-width:520px){ .hero{padding:30px 12px;} .card img{height:160px;} }
  </style>
</head>
<body>
<header>
  <h1>Paramount Phones & Gadgets</h1>
  <p>Your Number 1 Gadget Plug</p>
</header>

<nav>
  <a onclick="showSection('shop')">Shop</a>
  <a onclick="showSection('cart')">Cart üõí</a>
  <a onclick="showSection('admin')">Admin</a>
</nav>

<div class="hero" id="heroSection">
  <h2 id="heroTitle">Latest Phones at Hot Prices üî•</h2>
  <p id="heroText">Order Directly via WhatsApp</p>
  <button id="heroBtn" onclick="openWhatsApp()">Order Now</button>
</div>

<div id="searchWrapper">
  <input type="text" id="searchInput" placeholder="Search phones..." onkeyup="searchProducts()">
</div>

<!-- SHOP -->
<div class="products" id="shop"></div>

<!-- CART -->
<div id="cart">
  <h2>Your Cart</h2>
  <div id="cartItemsWrapper"></div>
  <input type="text" id="buyerName" placeholder="Your Name">
  <input type="email" id="buyerEmail" placeholder="Email Address">
  <input type="text" id="buyerPhone" placeholder="Phone Number">
  <input type="text" id="buyerAddress" placeholder="Delivery Address">
  <button onclick="checkout()">Pay & Order</button>
</div>

<!-- ADMIN -->
<div id="admin">
  <h2>Add / Manage Phones</h2>
  <input type="text" id="pname" placeholder="Phone Name">
  <input type="text" id="pprice" placeholder="Price (‚Ç¶)">
  <input type="text" id="pimage" placeholder="Image URL (optional)" oninput="previewURL()">
  <textarea id="pdesc" placeholder="Product Description"></textarea>
  <input type="file" id="pfile" accept="image/*" onchange="previewImage(event)">
  <img id="previewImg" src="" style="display:none; width:100%; max-height:220px; object-fit:contain; border-radius:12px; margin-bottom:10px;">
  <button onclick="addProduct()">Add Phone</button>

  <h3>Business Settings</h3>
  <input type="text" id="waNumber" placeholder="WhatsApp Number">
  <button class="smallBtn" onclick="saveWhatsAppNumber()">Save Number</button>
  <input type="password" id="adminPassChange" placeholder="Change Admin Password">
  <button class="smallBtn" onclick="saveAdminPassword()">Save Password</button>

  <h3>Edit Hero Section</h3>
  <input type="text" id="adminHeroTitle" placeholder="Hero Title">
  <input type="text" id="adminHeroText" placeholder="Hero Text">
  <input type="text" id="adminHeroBtnText" placeholder="Hero Button Text">
  <input type="color" id="adminHeroColor1" value="#ff4e50">
  <input type="color" id="adminHeroColor2" value="#f9d423">
  <button class="smallBtn" onclick="saveHero()">Save Hero</button>

  <h3>Existing Products</h3>
  <div id="adminProducts"></div>

  <h3>Orders</h3>
  <div id="ordersWrapper"></div>

  <h3>Visitor Count: <span id="visitCount">0</span></h3>
</div>

<footer>
  <p>Call / WhatsApp: <span id="footerNumber">+234 916 671 0777</span></p>
  <p>¬© 2025 Paramount Phones & Gadgets</p>
</footer>

<script src="https://js.paystack.co/v1/inline.js"></script>
<script>
let products = JSON.parse(localStorage.getItem("products")) || [
  {name:"iPhone 13", price:550000, image:"https://via.placeholder.com/200", hot:true, description:"The latest iPhone with amazing camera and performance."},
  {name:"Samsung A14", price:150000, image:"https://via.placeholder.com/200", hot:false, description:"Affordable Samsung phone with long-lasting battery."},
  {name:"Tecno Spark 20", price:135000, image:"https://via.placeholder.com/200", hot:false, description:"Stylish Tecno phone with good display."},
  {name:"Infinix Note 30", price:180000, image:"https://via.placeholder.com/200", hot:false, description:"Powerful Infinix with large screen and battery."}
];

let cart = [];
let orders = JSON.parse(localStorage.getItem("orders")) || [];
let visits = Number(localStorage.getItem("visits") || 0);
visits++; localStorage.setItem("visits", visits);
document.getElementById("visitCount").innerText = visits;

let waNumber = localStorage.getItem("waNumber") || "2349166710777";
document.getElementById("waNumber").value = waNumber;
document.getElementById("footerNumber").innerText = "+"+waNumber;

let adminPass = localStorage.getItem("adminPass") || "Paramountpaul1";
let uploadedImage = "";

// ---------- preview ----------
function previewImage(event){
  const file = event.target.files && event.target.files[0];
  if(!file) return;
  const reader = new FileReader();
  reader.onload = function(){
    uploadedImage = reader.result;
    const img = document.getElementById("previewImg");
    img.src = uploadedImage;
    img.style.display = "block";
  }
  reader.readAsDataURL(file);
}
function previewURL(){
  const url=document.getElementById("pimage").value.trim();
  if(uploadedImage) return;
  const img=document.getElementById("previewImg");
  if(!url){
    img.style.display="none";
    img.src="";
    return;
  }
  img.src=url; img.style.display="block";
}

// ---------- display products ----------
function displayProducts(){
  const shop=document.getElementById("shop");
  shop.innerHTML="";
  products.forEach((p,i)=>{
    shop.innerHTML += `
      <div class="card" onclick="viewProduct(${i})">
        ${p.hot?'<span class="hotBadge">Hot üî•</span>':''}
        <img src="${p.image}" alt="${escapeHtml(p.name)}">
        <h3>${escapeHtml(p.name)}</h3>
        <p>‚Ç¶${Number(p.price).toLocaleString()}</p>
      </div>
    `;
  });
}

function displayAdminProducts(){
  const adminDiv=document.getElementById("adminProducts");
  adminDiv.innerHTML="";
  products.forEach((p,i)=>{
    adminDiv.innerHTML+=`
      <div class="card">
        <img src="${p.image}">
        <h3>${escapeHtml(p.name)}</h3>
        <p>‚Ç¶${Number(p.price).toLocaleString()}</p>
        <p>${escapeHtml(p.description)}</p>
        <button class="smallBtn" onclick="editProduct(${i})">‚úèÔ∏è Edit</button>
        <button class="smallBtn" onclick="deleteProduct(${i})">üóëÔ∏è Delete</button>
        <button class="smallBtn" onclick="toggleHot(${i})">${p.hot?'üî• Remove Hot':'üî• Mark Hot'}</button>
      </div>
    `;
  });
}

// ---------- view product popup ----------
function viewProduct(i){
  const p = products[i];
  const html = `
    <div style="position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); display:flex; align-items:center; justify-content:center; z-index:9999;">
      <div style="background:white; padding:20px; border-radius:15px; max-width:500px; width:90%; text-align:center; position:relative;">
        <button onclick="this.parentElement.parentElement.remove()" style="position:absolute; top:10px; right:10px; font-size:18px;">‚úñ</button>
        <img src="${p.image}" style="width:100%; max-height:250px; object-fit:contain; border-radius:12px;">
        <h2>${escapeHtml(p.name)}</h2>
        <p><strong>Price:</strong> ‚Ç¶${Number(p.price).toLocaleString()}</p>
        <p>${escapeHtml(p.description)}</p>
        <button onclick="addToCart(${i}); this.parentElement.parentElement.remove()">Add to Cart</button>
      </div>
    </div>
  `;
  document.body.insertAdjacentHTML('beforeend', html);
}

// ---------- cart ----------
function addToCart(i){
  let product = products[i];
  let existing = cart.find(item => item.name === product.name);
  if(existing){ existing.qty += 1; } else { cart.push({name:product.name, price:Number(product.price), image:product.image, qty:1}); }
  displayCart(); alert("Added to Cart ‚úÖ");
}

function displayCart(){
  const cartDiv=document.getElementById("cartItemsWrapper");
  cartDiv.innerHTML="";
  cart.forEach((p,i)=>{
    cartDiv.innerHTML += `
      <div class="card">
        <img src="${p.image}">
        <h3>${escapeHtml(p.name)}</h3>
        <p>‚Ç¶${Number(p.price).toLocaleString()}</p>
        <p><strong>Qty:</strong> 
          <button class="smallBtn" onclick="decreaseQty(${i})">-</button>
          ${p.qty}
          <button class="smallBtn" onclick="increaseQty(${i})">+</button>
        </p>
        <p><strong>Subtotal:</strong> ‚Ç¶${(p.price * p.qty).toLocaleString()}</p>
        <button onclick="removeFromCart(${i})">Remove</button>
      </div>
    `;
  });
  let total = cart.reduce((t, item) => t + (item.price * item.qty), 0);
  cartDiv.innerHTML += `<h3>Total: ‚Ç¶${total.toLocaleString()}</h3>`;
}

function increaseQty(i){ cart[i].qty++; displayCart(); }
function decreaseQty(i){ if(cart[i].qty>1){cart[i].qty--;}else{cart.splice(i,1);} displayCart(); }
function removeFromCart(i){ cart.splice(i,1); displayCart(); }

// ---------- checkout ----------
function checkout(){
  const name=document.getElementById("buyerName").value.trim();
  const email=document.getElementById("buyerEmail").value.trim();
  const phone=document.getElementById("buyerPhone").value.trim();
  const address=document.getElementById("buyerAddress").value.trim();
  if(!name||!email||!phone||!address||cart.length===0){ alert("Fill all details & cart cannot be empty"); return; }

  const total = cart.reduce((a,b)=> a + (b.price * b.qty), 0);
  orders.push({name,email,phone,address,items:cart.map(item=>({name:item.name,price:item.price,qty:item.qty,subtotal:item.price*item.qty})), total});
  localStorage.setItem("orders", JSON.stringify(orders));

  var handler = PaystackPop.setup({
    key:'pk_test_162ba6ca046d82c62b847013ea3230a862921046',
    email: email,
    amount: total * 100,
    currency:"NGN",
    ref:'' + Math.floor(Math.random()*1000000000 + 1),
    metadata:{
      custom_fields:[
        {display_name:"Customer Name", value:name},
        {display_name:"Email", value:email},
        {display_name:"Phone", value:phone},
        {display_name:"Address", value:address}
      ]
    },
    callback:function(response){
      alert('Payment Successful. Ref: ' + response.reference);
      // Send details to WhatsApp
      let waMsg = `Hello! New order:\nName: ${name}\nPhone: ${phone}\nAddress: ${address}\nTotal: ‚Ç¶${total.toLocaleString()}\nRef: ${response.reference}`;
      window.open(`https://wa.me/${waNumber}?text=${encodeURIComponent(waMsg)}`, '_blank');
      cart=[]; displayCart(); displayOrders();
    },
    onClose:function(){ alert('Payment Cancelled'); }
  });
  handler.openIframe();
}

// ---------- orders ----------
function displayOrders(){
  const ordersDiv=document.getElementById("ordersWrapper");
  ordersDiv.innerHTML="";
  if(orders.length===0){ ordersDiv.innerHTML="<p>No orders yet.</p>"; return; }
  orders.forEach((o,i)=>{
    ordersDiv.innerHTML+=`
      <div class="card">
        <h3>Order #${i+1}</h3>
        <p><strong>Name:</strong> ${escapeHtml(o.name)}</p>
        <p><strong>Email:</strong> ${escapeHtml(o.email)}</p>
        <p><strong>Phone:</strong> ${escapeHtml(o.phone)}</p>
        <p><strong>Address:</strong> ${escapeHtml(o.address)}</p>
        <p><strong>Items:</strong></p>
        <ul>
          ${o.items.map(it=>`<li>${escapeHtml(it.name)} ‚Äî ‚Ç¶${it.price.toLocaleString()} √ó ${it.qty} = ‚Ç¶${it.subtotal.toLocaleString()}</li>`).join('')}
        </ul>
        <p><strong>Total:</strong> ‚Ç¶${o.total.toLocaleString()}</p>
      </div>
    `;
  });
}

// ---------- admin functions ----------
function addProduct(){
  const name=document.getElementById("pname").value.trim();
  const price=document.getElementById("pprice").value.trim();
  const desc=document.getElementById("pdesc").value.trim();
  const url=document.getElementById("pimage").value.trim();
  const image=uploadedImage || url;
  if(!name||!price||!image||!desc){ alert("Fill name, price, image & description."); return; }
  products.push({name, price:parseFloat(price), image, hot:false, description:desc});
  localStorage.setItem("products", JSON.stringify(products));
  document.getElementById("pname").value=""; document.getElementById("pprice").value="";
  document.getElementById("pdesc").value=""; document.getElementById("pimage").value="";
  document.getElementById("pfile").value=""; uploadedImage=""; document.getElementById("previewImg").style.display="none";
  displayProducts(); displayAdminProducts(); alert("Product Added ‚úÖ");
}

function editProduct(i){
  const newName=prompt("Enter new phone name:", products[i].name);
  const newPrice=prompt("Enter new price:", products[i].price);
  const newDesc=prompt("Enter new description:", products[i].description);
  const newImage=prompt("Enter new image URL (leave blank to keep current):", products[i].image);
  if(newName && newPrice && newDesc){
    products[i] = {
      name: newName,
      price: parseFloat(newPrice),
      image: newImage ? newImage : products[i].image,
      hot: products[i].hot,
      description: newDesc
    };
    localStorage.setItem("products", JSON.stringify(products));
    displayProducts();
    displayAdminProducts();
    alert("Product Updated ‚úÖ");
  }
}

function deleteProduct(i){
  if(confirm("Delete this product?")){
    products.splice(i,1);
    localStorage.setItem("products", JSON.stringify(products));
    displayProducts();
    displayAdminProducts();
  }
}

function toggleHot(i){
  products[i].hot = !products[i].hot;
  localStorage.setItem("products", JSON.stringify(products));
  displayProducts();
  displayAdminProducts();
}

function saveWhatsAppNumber(){
  const val = document.getElementById("waNumber").value.trim();
  if(!val){ alert("Enter number"); return; }
  waNumber = val;
  localStorage.setItem("waNumber", val);
  document.getElementById("footerNumber").innerText = "+" + val;
  alert("WhatsApp number saved ‚úÖ");
}

function saveAdminPassword(){
  const val = document.getElementById("adminPassChange").value.trim();
  if(!val){ alert("Enter password"); return; }
  adminPass = val;
  localStorage.setItem("adminPass", val);
  document.getElementById("adminPassChange").value = "";
  alert("Password saved ‚úÖ");
}

function saveHero(){
  const title = document.getElementById("adminHeroTitle").value.trim();
  const text = document.getElementById("adminHeroText").value.trim();
  const btnText = document.getElementById("adminHeroBtnText").value.trim();
  const color1 = document.getElementById("adminHeroColor1").value;
  const color2 = document.getElementById("adminHeroColor2").value;

  if(title) document.getElementById("heroTitle").innerText = title;
  if(text) document.getElementById("heroText").innerText = text;
  if(btnText) document.getElementById("heroBtn").innerText = btnText;
  document.getElementById("heroSection").style.background = `linear-gradient(120deg,${color1},${color2})`;
  alert("Hero Section Updated ‚úÖ");
}

function openWhatsApp(){
  window.open(`https://wa.me/${waNumber}?text=${encodeURIComponent("Hello, I want to order via the hero button")}`);
}

function searchProducts(){
  const q = document.getElementById("searchInput").value.trim().toLowerCase();
  const shop = document.getElementById("shop");
  shop.innerHTML = "";
  products.forEach((p,i)=>{
    if(p.name.toLowerCase().includes(q)){
      shop.innerHTML += `
        <div class="card" onclick="viewProduct(${i})">
          ${p.hot?'<span class="hotBadge">Hot üî•</span>':''}
          <img src="${p.image}">
          <h3>${escapeHtml(p.name)}</h3>
          <p>‚Ç¶${Number(p.price).toLocaleString()}</p>
        </div>
      `;
    }
  });
}

function showSection(section){
  if(section==='admin'){
    const pass = prompt("Enter Admin Password:");
    if(pass!==adminPass){ alert("Wrong password ‚ùå"); return; }
  }
  document.getElementById("shop").style.display="none";
  document.getElementById("cart").style.display="none";
  document.getElementById("admin").style.display="none";
  document.getElementById(section).style.display="block";
  displayOrders();
}

function escapeHtml(str){
  return String(str||"").replace(/[&<>"']/g, s => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[s]));
}

displayProducts();
displayAdminProducts();
</script>
</body>
</html>